<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="Halit Cengiz Uzuner — Dijital organizma. Düşünme disiplini, argümantasyon refleksi, sınırsız merak.">
    <meta name="author" content="Halit Cengiz Uzuner">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Halit Cengiz Uzuner">
    <meta property="og:description" content="Dijital organizma. Düşünme disiplini, argümantasyon refleksi, sınırsız merak.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://halitcengizuzuner.com/">
    <link rel="canonical" href="https://halitcengizuzuner.com/">
    <!-- Hreflang -->
    <link rel="alternate" hreflang="tr" href="https://halitcengizuzuner.com/">
    <link rel="alternate" hreflang="en" href="https://halitcengizuzuner.com/">
    <link rel="alternate" hreflang="x-default" href="https://halitcengizuzuner.com/">
    <!-- OG extras -->
    <meta property="og:locale" content="tr_TR">
    <meta property="og:locale:alternate" content="en_US">
    <meta property="og:site_name" content="Halit Cengiz Uzuner">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Halit Cengiz Uzuner">
    <meta name="twitter:description" content="Dijital organizma. Düşünme disiplini, argümantasyon refleksi, sınırsız merak.">
    <!-- JSON-LD Person Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Halit Cengiz Uzuner",
        "url": "https://halitcengizuzuner.com",
        "description": "1995'ten beri hukukçu. Düşünme disiplini, argümantasyon refleksi, sınırsız merak.",
        "jobTitle": "Hukukçu",
        "knowsLanguage": ["tr", "en"]
    }
    </script>
    <title>Halit Cengiz Uzuner</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Crimson+Pro:ital,wght@0,300;0,400;0,600;1,400&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Muted professional palette */
            --bg-primary: #E8E4DE;
            --bg-warm: #DDD8D0;
            --bg-surface: rgba(255, 255, 255, 0.50);
            --bg-surface-hover: rgba(255, 255, 255, 0.65);
            --bg-surface-solid: #F0ECE6;
            --bg-overlay: rgba(232, 228, 222, 0.95);

            --amber: #7A6B4E;
            --amber-deep: #5C5038;
            --amber-glow: rgba(122, 107, 78, 0.15);
            --amber-soft: rgba(122, 107, 78, 0.06);
            --amber-ring: rgba(122, 107, 78, 0.10);

            --teal: #4A706A;
            --blue: #4A6A8A;
            --purple: #6B5B7B;
            --red: #8B5A5A;
            --green: #5A7A5A;
            --orange: #8A6A4A;
            --silver: #7A7A7A;

            --text-primary: #2A2A2A;
            --text-secondary: #4A4640;
            --text-muted: #7A7670;
            --text-light: #A09A90;
            --border-subtle: rgba(0, 0, 0, 0.05);
            --border-glass: rgba(255, 255, 255, 0.40);
            
            --font-display: 'Instrument Serif', serif;
            --font-body: 'Crimson Pro', serif;
            --font-mono: 'JetBrains Mono', monospace;
            
            --transition-page: 0.35s;
            --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
            --blur-card: 24px;
        }

        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
            -webkit-text-size-adjust: 100%;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: var(--font-body);
            line-height: 1.6;
            min-height: 100vh;
            min-height: 100dvh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            -webkit-tap-highlight-color: transparent;
            position: relative;
        }

        /* Living Background */
        .bg-layer {
            position: fixed; inset: 0; z-index: 0;
            pointer-events: none; overflow: hidden;
        }
        .bg-grain {
            position: absolute; inset: 0; opacity: 0.4;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.5'/%3E%3C/svg%3E");
            background-repeat: repeat; background-size: 200px 200px;
            mix-blend-mode: multiply; z-index: 2;
        }
        .fog-blob {
            position: absolute; border-radius: 50%;
            filter: blur(80px); opacity: 0;
            animation: fog-drift 25s ease-in-out infinite;
            will-change: transform;
        }
        .fog-blob.amber-1 { width: 400px; height: 400px; background: radial-gradient(circle, rgba(122,107,78,0.22) 0%, transparent 70%); top: 15%; left: 20%; animation-delay: 0s; animation-duration: 28s; }
        .fog-blob.teal-1 { width: 350px; height: 350px; background: radial-gradient(circle, rgba(26,122,109,0.18) 0%, transparent 70%); top: 50%; right: 10%; animation-delay: -8s; animation-duration: 32s; }
        .fog-blob.purple-1 { width: 300px; height: 300px; background: radial-gradient(circle, rgba(109,40,217,0.14) 0%, transparent 70%); bottom: 20%; left: 10%; animation-delay: -15s; animation-duration: 30s; }
        .fog-blob.orange-1 { width: 280px; height: 280px; background: radial-gradient(circle, rgba(194,65,12,0.14) 0%, transparent 70%); top: 30%; right: 30%; animation-delay: -20s; animation-duration: 35s; }
        .fog-blob.blue-1 { width: 320px; height: 320px; background: radial-gradient(circle, rgba(37,99,235,0.12) 0%, transparent 70%); bottom: 30%; right: 20%; animation-delay: -5s; animation-duration: 26s; }
        @keyframes fog-drift {
            0% { opacity: 0.7; transform: translate(0, 0) scale(1); }
            25% { opacity: 1; transform: translate(30px, -20px) scale(1.1); }
            50% { opacity: 0.8; transform: translate(-20px, 15px) scale(0.95); }
            75% { opacity: 1; transform: translate(15px, 25px) scale(1.05); }
            100% { opacity: 0.7; transform: translate(0, 0) scale(1); }
        }

        /* Glass card base */
        .glass-card {
            background: var(--bg-surface);
            backdrop-filter: blur(var(--blur-card));
            -webkit-backdrop-filter: blur(var(--blur-card));
            border: 1px solid var(--border-glass);
            border-radius: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04), inset 0 1px 0 rgba(255,255,255,0.4);
            transition: all 0.3s ease;
        }
        .glass-card:hover {
            background: var(--bg-surface-hover);
            box-shadow: 0 4px 20px rgba(0,0,0,0.06), inset 0 1px 0 rgba(255,255,255,0.5);
        }

        /* Nerve network — organism's connective tissue across all pages */
        .nerve-network {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
            overflow: hidden;
        }

        .nerve-network svg {
            width: 100%;
            height: 100%;
            opacity: 0.06;
        }

        .nerve-line {
            stroke: var(--amber);
            stroke-width: 0.5;
            fill: none;
            stroke-dasharray: 4 12;
        }

        .nerve-dot {
            fill: var(--amber);
            opacity: 0.4;
        }

        /* Page identity gradients — each page has its own color atmosphere */
        .page-gradient {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50vh;
            pointer-events: none;
            z-index: 0;
            opacity: 0.7;
        }

        .page-gradient.amber-gradient {
            background: radial-gradient(ellipse 80% 50% at 50% 0%, rgba(122,107,78,0.1) 0%, transparent 70%);
        }

        .page-gradient.multi-gradient {
            background: 
                radial-gradient(ellipse 40% 40% at 25% 0%, rgba(26,122,109,0.08) 0%, transparent 60%),
                radial-gradient(ellipse 40% 40% at 75% 0%, rgba(109,40,217,0.06) 0%, transparent 60%),
                radial-gradient(ellipse 30% 30% at 50% 10%, rgba(122,107,78,0.07) 0%, transparent 60%);
        }

        .page-gradient.teal-gradient {
            background: radial-gradient(ellipse 80% 50% at 50% 0%, rgba(26,122,109,0.1) 0%, transparent 70%);
        }

        .page-gradient.red-gradient {
            background: radial-gradient(ellipse 60% 40% at 50% 0%, rgba(185,28,28,0.08) 0%, transparent 70%);
        }

        /* ========================================
           UNSUPPORTED GATE
           ======================================== */
        #unsupported-gate {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 10000;
            background: #E8E4DE;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
        }

        #unsupported-gate p {
            font-family: Georgia, serif;
            font-size: 1rem;
            color: var(--amber-deep);
            line-height: 2;
            max-width: 400px;
        }

        /* ========================================
           INTRO
           ======================================== */
        #intro-overlay {
            position: fixed;
            inset: 0;
            z-index: 9000;
            background: var(--bg-primary);
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 0.6s ease;
        }

        #intro-overlay.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .intro-core {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--amber);
            box-shadow: 0 0 30px var(--amber-glow), 0 0 60px rgba(122, 107, 78, 0.1);
            animation: intro-breathe-light 1.5s ease-in-out infinite, intro-grow 2s var(--ease-out-expo) forwards;
        }

        @keyframes intro-breathe-light {
            0%, 100% { box-shadow: 0 0 30px var(--amber-glow), 0 0 60px rgba(122, 107, 78, 0.1); }
            50% { box-shadow: 0 0 50px var(--amber-glow), 0 0 90px rgba(122, 107, 78, 0.08); }
        }

        @keyframes intro-grow {
            0% { transform: scale(0.3); opacity: 0; }
            30% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* ========================================
           APP SHELL
           ======================================== */
        #app {
            opacity: 0;
            transition: opacity 0.5s ease;
            min-height: 100vh;
            min-height: 100dvh;
            position: relative;
            z-index: 1;
        }

        #app.visible { opacity: 1; }

        /* ========================================
           HEADER
           ======================================== */
        .site-header {
            position: fixed;
            top: 0; left: 0; right: 0;
            z-index: 500;
            padding: 1.25rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            pointer-events: none;
        }

        .site-header > * { pointer-events: auto; }

        .lang-toggle {
            display: flex; gap: 1px;
            background: var(--bg-surface);
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border-radius: 6px; overflow: hidden;
            border: 1px solid var(--border-glass);
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
        }

        .lang-btn {
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-family: var(--font-mono);
            font-size: 0.7rem;
            font-weight: 400;
            letter-spacing: 0.1em;
            padding: 0.4rem 0.7rem;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .lang-btn:hover { color: var(--text-secondary); }

        .lang-btn.active {
            color: var(--amber-deep);
            background: var(--amber-soft);
        }

        .nav-wrapper {
            position: relative;
        }

        .hamburger {
            display: flex; flex-direction: column;
            justify-content: center; align-items: center; gap: 4px;
            background: var(--bg-surface);
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--border-glass);
            border-radius: 6px; cursor: pointer;
            transition: all 0.3s ease;
            padding: 0.5rem 0.7rem;
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
        }
        .hamburger:hover { background: var(--bg-surface-hover); }

        .hamburger-lines {
            display: flex; flex-direction: column; gap: 4px;
            align-items: center;
        }

        .hamburger-lines span {
            display: block;
            width: 16px;
            height: 1.5px;
            background: var(--text-secondary);
            transition: all 0.3s var(--ease-out-expo);
            transform-origin: center;
        }

        .hamburger.open .hamburger-lines span:nth-child(1) { transform: rotate(45deg) translate(2px, 2px); }
        .hamburger.open .hamburger-lines span:nth-child(2) { opacity: 0; transform: scaleX(0); }
        .hamburger.open .hamburger-lines span:nth-child(3) { transform: rotate(-45deg) translate(2px, -2px); }

        .hamburger-label {
            font-family: var(--font-mono);
            font-size: 0.45rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--text-light);
            margin-top: 2px;
        }

        /* Nav Dropdown */
        .nav-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: rgba(255,255,255,0.78);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid var(--border-glass);
            border-radius: 10px;
            padding: 0.6rem 0;
            min-width: 200px;
            opacity: 0;
            pointer-events: none;
            transform: translateY(-8px);
            transition: all 0.25s var(--ease-out-expo);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            z-index: 500;
        }

        .nav-dropdown.open {
            opacity: 1;
            pointer-events: auto;
            transform: translateY(0);
        }

        .nav-menu {
            list-style: none;
            display: flex;
            flex-direction: column;
        }

        .nav-link {
            font-family: var(--font-display);
            font-size: 1.15rem;
            color: var(--text-muted);
            text-decoration: none;
            display: flex;
            align-items: baseline;
            gap: 0.6rem;
            padding: 0.55rem 1.2rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .nav-link:hover {
            color: var(--amber-deep);
            background: rgba(122,107,78,0.04);
        }

        .nav-link-sub {
            display: block;
            font-family: var(--font-mono);
            font-size: 0.6rem;
            letter-spacing: 0.2em;
            color: var(--text-light);
            margin-top: 0.25rem;
            text-transform: uppercase;
        }

        /* ========================================
           PAGES
           ======================================== */
        .page {
            display: none;
            min-height: 100vh;
            min-height: 100dvh;
        }

        .page.active {
            display: block;
            animation: pageEnter 0.4s var(--ease-out-expo) forwards;
        }

        .page.exiting {
            animation: pageExit 0.3s ease-out forwards;
        }

        @keyframes pageEnter {
            0% { opacity: 0; transform: translateY(12px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        @keyframes pageExit {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* ========================================
           HOME — ORGANISM
           ======================================== */
        .home {
            display: grid;
            grid-template-columns: auto 1fr;
            grid-template-rows: 1fr auto;
            align-items: start;
            justify-items: start;
            min-height: 100vh;
            min-height: 100dvh;
            padding: 5rem 2.5rem 3rem;
            position: relative;
            gap: 0;
        }

        /* Subtle radial warmth behind entity */
        .home::before {
            content: '';
            position: absolute;
            top: 5rem;
            left: 0;
            width: min(420px, 65vw);
            height: min(420px, 65vw);
            background: radial-gradient(circle, rgba(122, 107, 78, 0.05) 0%, transparent 65%);
            pointer-events: none;
            z-index: 0;
        }

        .entity-container {
            position: relative;
            width: clamp(220px, 42vw, 360px);
            height: clamp(220px, 42vw, 360px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1;
            grid-column: 1;
            grid-row: 1;
        }

        .entity-core {
            width: clamp(56px, 11vw, 80px);
            height: clamp(56px, 11vw, 80px);
            border-radius: 50%;
            background: radial-gradient(circle, var(--amber) 0%, rgba(122, 107, 78, 0.7) 40%, rgba(122, 107, 78, 0.15) 70%, transparent 100%);
            box-shadow:
                0 0 30px var(--amber-glow),
                0 0 60px rgba(122, 107, 78, 0.08);
            animation: core-pulse-light 3.5s ease-in-out infinite;
            position: relative;
            z-index: 2;
        }

        @keyframes core-pulse-light {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 0 30px var(--amber-glow), 0 0 60px rgba(122, 107, 78, 0.08);
            }
            50% { 
                transform: scale(1.04); 
                box-shadow: 0 0 45px var(--amber-glow), 0 0 80px rgba(122, 107, 78, 0.06);
            }
        }

        /* Video layer */
        .entity-video-layer {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: clamp(90px, 20vw, 140px);
            height: clamp(90px, 20vw, 140px);
            border-radius: 50%;
            overflow: hidden;
            z-index: 3;
            opacity: 0;
            transition: opacity 1s ease;
        }

        .entity-video-layer.loaded { opacity: 1; }

        .entity-video-layer video {
            width: 100%; height: 100%;
            object-fit: cover;
            mix-blend-mode: multiply;
        }

        /* Name on core */
        .entity-name {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 4;
            text-align: center;
            pointer-events: none;
        }

        .entity-name-primary {
            font-family: var(--font-display);
            font-size: clamp(1.1rem, 2.5vw, 1.5rem);
            color: var(--bg-primary);
            letter-spacing: 0.15em;
            text-shadow: 0 1px 4px rgba(0,0,0,0.15);
            font-weight: 400;
        }

        /* Orbital ring */
        .orbital-ring {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 10;
        }

        .connections-svg {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .connection-line {
            stroke: var(--amber);
            stroke-width: 0.8;
            opacity: 0.1;
            stroke-dasharray: 3 6;
        }

        .limb-node {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.4rem;
            pointer-events: auto;
            cursor: default;
            transform: translate(-50%, -50%);
            transition: transform 0.3s var(--ease-out-expo);
        }

        .limb-node:hover { transform: translate(-50%, -50%) scale(1.1); }

        .limb-dot {
            width: clamp(14px, 3vw, 20px);
            height: clamp(14px, 3vw, 20px);
            border-radius: 50%;
            position: relative;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: box-shadow 0.3s ease;
        }

        .limb-node:hover .limb-dot {
            box-shadow: 0 2px 16px rgba(0,0,0,0.15);
        }

        .limb-dot::after {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            border: 1px solid currentColor;
            opacity: 0.2;
            animation: limb-ring-pulse 3s ease-in-out infinite;
        }

        @keyframes limb-ring-pulse {
            0%, 100% { transform: scale(1); opacity: 0.2; }
            50% { transform: scale(1.35); opacity: 0.06; }
        }

        .limb-label {
            font-family: var(--font-mono);
            font-size: clamp(0.5rem, 1.1vw, 0.6rem);
            font-weight: 500;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            white-space: nowrap;
            opacity: 0.65;
            transition: opacity 0.3s ease;
        }

        .limb-node:hover .limb-label { opacity: 1; }

        .limb-tooltip {
            position: absolute;
            bottom: calc(100% + 14px);
            left: 50%;
            transform: translateX(-50%) translateY(5px);
            background: rgba(255,255,255,0.72);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border-glass);
            border-radius: 10px;
            padding: 0.7rem 0.9rem;
            min-width: 170px;
            text-align: center;
            opacity: 0;
            pointer-events: none;
            transition: all 0.25s var(--ease-out-expo);
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .limb-tooltip.tooltip-below {
            bottom: auto;
            top: calc(100% + 14px);
        }

        .limb-node:hover .limb-tooltip {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .limb-tooltip-name {
            font-family: var(--font-mono);
            font-size: 0.6rem;
            letter-spacing: 0.1em;
            color: var(--text-light);
            margin-bottom: 0.2rem;
        }

        .limb-tooltip-role {
            font-family: var(--font-body);
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .limb-node.sleeping .limb-dot { opacity: 0.35; }
        .limb-node.sleeping .limb-label { opacity: 0.3; }
        .limb-node.sleeping .limb-dot::after { animation-duration: 8s; }

        .home-info {
            grid-column: 2;
            grid-row: 1;
            align-self: center;
            padding-left: clamp(1rem, 3vw, 3rem);
            z-index: 1;
        }

        .home-fullname-large {
            font-family: var(--font-display);
            font-size: clamp(2.2rem, 5vw, 3.6rem);
            color: var(--text-primary);
            line-height: 1.15;
            margin-bottom: 1.2rem;
            letter-spacing: -0.01em;
        }

        .home-fullname-large span {
            display: block;
        }

        .home-philosophy {
            z-index: 1;
        }

        .home-philosophy p {
            font-family: var(--font-body);
            font-style: italic;
            font-size: clamp(0.95rem, 2vw, 1.15rem);
            color: var(--text-muted);
            letter-spacing: 0.03em;
            line-height: 1.6;
            max-width: 380px;
        }

        .home-fullname {
            margin-top: 1.5rem;
            z-index: 1;
        }

        .home-fullname span {
            font-family: var(--font-mono);
            font-size: 0.55rem;
            letter-spacing: 0.35em;
            color: var(--text-light);
            text-transform: uppercase;
        }

        /* ========================================
           CORE PAGE
           ======================================== */
        .page-core {
            padding: 7rem 1.5rem 4rem;
            max-width: 680px;
            margin: 0 auto;
            position: relative;
        }

        .core-header { text-align: center; margin-bottom: 3rem; }

        .core-title {
            font-family: var(--font-display);
            font-size: clamp(2rem, 5vw, 3rem);
            color: var(--amber-deep);
            margin-bottom: 0.4rem;
        }

        .core-subtitle {
            font-family: var(--font-mono);
            font-size: 0.6rem;
            letter-spacing: 0.3em;
            color: var(--text-light);
            text-transform: uppercase;
        }

        .core-body {
            font-family: var(--font-body);
            font-size: clamp(1.05rem, 2.2vw, 1.2rem);
            color: var(--text-secondary);
            line-height: 1.9;
            text-align: center;
            margin-bottom: 3.5rem;
        }

        .branches-title {
            font-family: var(--font-mono);
            font-size: 0.6rem;
            letter-spacing: 0.25em;
            color: var(--text-light);
            text-transform: uppercase;
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .branch-filters {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 1.5rem;
        }

        .branch-filter-btn {
            font-family: var(--font-mono);
            font-size: 0.55rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--text-light);
            background: transparent;
            border: 1px solid var(--border-subtle);
            padding: 0.4rem 0.9rem;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .branch-filter-btn:hover {
            border-color: var(--amber-ring);
            color: var(--amber-deep);
        }

        .branch-filter-btn.active {
            border-color: var(--amber-ring);
            color: var(--amber-deep);
            background: rgba(122, 107, 78, 0.06);
        }

        .branch-filter-count {
            font-size: 0.5rem;
            opacity: 0.5;
            margin-left: 0.2rem;
        }

        .branch-card {
            padding: 1.3rem 1.5rem;
            margin-bottom: 1rem;
        }
        .branch-card:hover { border-color: var(--amber-ring); }

        .branch-date {
            font-family: var(--font-mono);
            font-size: 0.6rem;
            color: var(--text-light);
            letter-spacing: 0.12em;
        }

        .branch-title {
            font-family: var(--font-display);
            font-size: 1.15rem;
            color: var(--text-primary);
            margin: 0.3rem 0;
        }

        .branch-desc {
            font-family: var(--font-body);
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .branch-status {
            display: inline-block;
            font-family: var(--font-mono);
            font-size: 0.5rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            padding: 0.2rem 0.6rem;
            border-radius: 3px;
            margin-top: 0.5rem;
        }

        .branch-status.active {
            color: var(--green);
            background: rgba(21, 128, 61, 0.08);
            border: 1px solid rgba(21, 128, 61, 0.15);
        }

        .branch-status.completed {
            color: var(--amber-deep);
            background: var(--amber-soft);
            border: 1px solid var(--amber-ring);
        }

        /* ========================================
           ASSEMBLY PAGE
           ======================================== */
        .page-assembly {
            padding: 7rem 1.5rem 4rem;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }

        .assembly-header { text-align: center; margin-bottom: 3rem; }

        .assembly-title {
            font-family: var(--font-display);
            font-size: clamp(2rem, 5vw, 3rem);
            color: var(--amber-deep);
            margin-bottom: 0.4rem;
        }

        .assembly-subtitle {
            font-family: var(--font-mono);
            font-size: 0.6rem;
            letter-spacing: 0.3em;
            color: var(--text-light);
            text-transform: uppercase;
        }

        .assembly-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 1rem;
        }

        .limb-card {
            padding: 1.4rem; position: relative; overflow: hidden;
        }
        .limb-card:hover { transform: translateY(-2px); }

        .limb-card-header {
            display: flex;
            align-items: center;
            gap: 0.7rem;
            margin-bottom: 0.6rem;
        }

        .limb-card-dot {
            width: 10px; height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .limb-card-persona {
            font-family: var(--font-mono);
            font-size: 0.8rem;
            font-weight: 500;
            letter-spacing: 0.1em;
        }

        .limb-card-tool {
            font-family: var(--font-body);
            font-style: italic;
            font-size: 0.8rem;
            color: var(--text-light);
            margin-bottom: 0.4rem;
        }

        .limb-card-role {
            font-family: var(--font-body);
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .limb-card-status {
            font-family: var(--font-mono);
            font-size: 0.5rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            margin-top: 0.7rem;
            display: flex;
            align-items: center;
            gap: 0.35rem;
        }

        .status-dot {
            width: 5px; height: 5px;
            border-radius: 50%;
            animation: status-blink 2s ease-in-out infinite;
        }

        .status-dot.sleeping { animation-duration: 6s; opacity: 0.35; }

        @keyframes status-blink {
            0%, 100% { opacity: 0.35; }
            50% { opacity: 1; }
        }

        /* ========================================
           EMANATIONS PAGE
           ======================================== */
        .page-emanations {
            padding: 7rem 1.5rem 4rem;
            max-width: 760px;
            margin: 0 auto;
            position: relative;
        }

        .emanations-header { text-align: center; margin-bottom: 3rem; }

        .emanations-title {
            font-family: var(--font-display);
            font-size: clamp(2rem, 5vw, 3rem);
            color: var(--amber-deep);
            margin-bottom: 0.4rem;
        }

        .emanations-subtitle {
            font-family: var(--font-mono);
            font-size: 0.6rem;
            letter-spacing: 0.3em;
            color: var(--text-light);
            text-transform: uppercase;
        }

        .emanation-filters {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .emanation-filter-btn {
            font-family: var(--font-mono);
            font-size: 0.55rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--text-light);
            background: transparent;
            border: 1px solid var(--border-subtle);
            padding: 0.4rem 0.9rem;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .emanation-filter-btn:hover {
            border-color: var(--teal);
            color: var(--teal);
        }

        .emanation-filter-btn.active {
            border-color: var(--teal);
            color: var(--teal);
            background: rgba(26, 122, 109, 0.06);
        }

        .emanation-filter-count {
            font-size: 0.5rem;
            opacity: 0.5;
            margin-left: 0.2rem;
        }

        .emanation-card { padding: 1.8rem; margin-bottom: 1.2rem; }
        .emanation-card:hover { border-color: var(--amber-ring); }

        .emanation-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 0.6rem;
        }

        .emanation-category {
            font-family: var(--font-mono);
            font-size: 0.55rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--teal);
            font-weight: 500;
        }

        .emanation-date {
            font-family: var(--font-mono);
            font-size: 0.55rem;
            color: var(--text-light);
            letter-spacing: 0.1em;
        }

        .emanation-title {
            font-family: var(--font-display);
            font-size: 1.25rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .emanation-summary {
            font-family: var(--font-body);
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 1.2rem;
        }

        .emanation-actions { display: flex; gap: 0.7rem; flex-wrap: wrap; }

        .emanation-btn {
            font-family: var(--font-mono);
            font-size: 0.6rem;
            font-weight: 400;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--text-secondary);
            background: transparent;
            border: 1px solid var(--border-subtle);
            padding: 0.55rem 1.1rem;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s ease;
        }

        .emanation-btn:hover {
            border-color: var(--teal);
            color: var(--teal);
            background: rgba(26, 122, 109, 0.04);
        }

        .emanation-btn.listen:hover {
            border-color: var(--purple);
            color: var(--purple);
            background: rgba(109, 40, 217, 0.04);
        }

        .emanation-illustration {
            text-align: center;
            margin-bottom: 1.2rem;
            opacity: 0.55;
            transition: opacity 0.3s ease;
        }
        .emanation-card:hover .emanation-illustration { opacity: 0.75; }
        .emanation-illustration svg {
            width: 100%;
            max-width: 260px;
            height: auto;
        }

        /* ========================================
           PORTAL
           ======================================== */
        .page-portal {
            padding: 7rem 1.5rem 4rem;
            max-width: 540px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            min-height: 100dvh;
        }

        .portal-header { text-align: center; margin-bottom: 2.5rem; }

        .portal-title {
            font-family: var(--font-display);
            font-size: clamp(2rem, 5vw, 3rem);
            color: var(--amber-deep);
            margin-bottom: 1rem;
        }

        .portal-statement {
            font-family: var(--font-body);
            font-size: clamp(0.95rem, 2vw, 1.05rem);
            color: var(--text-secondary);
            line-height: 1.8;
            font-style: italic;
        }

        .portal-choice {
            display: flex; gap: 0.8rem; justify-content: center;
            margin-bottom: 2rem;
        }
        .portal-choice-btn {
            font-family: var(--font-mono);
            font-size: 0.6rem; font-weight: 400;
            letter-spacing: 0.15em; text-transform: uppercase;
            color: var(--text-muted);
            background: rgba(255,255,255,0.4);
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--border-glass);
            padding: 0.7rem 1.5rem; border-radius: 4px;
            cursor: pointer; transition: all 0.3s ease;
        }
        .portal-choice-btn:hover { border-color: var(--amber-ring); color: var(--amber-deep); }
        .portal-choice-btn.active {
            border-color: var(--amber); color: var(--amber-deep);
            background: var(--amber-soft);
        }
        .portal-form { width: 100%; }

        .portal-textarea {
            width: 100%; min-height: 140px;
            background: rgba(255,255,255,0.5);
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--border-glass); border-radius: 10px;
            padding: 1rem 1.2rem; color: var(--text-primary);
            font-family: var(--font-body); font-size: 0.95rem; line-height: 1.6;
            resize: vertical; transition: all 0.3s ease;
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.3);
        }
        .portal-textarea:focus { outline: none; border-color: var(--amber-ring); box-shadow: 0 0 0 3px rgba(122,107,78,0.06), inset 0 1px 0 rgba(255,255,255,0.3); }

        .portal-textarea::placeholder { color: var(--text-light); font-style: italic; }

        .portal-char-count {
            font-family: var(--font-mono);
            font-size: 0.55rem;
            color: var(--text-light);
            text-align: right;
            margin-top: 0.3rem;
            letter-spacing: 0.1em;
        }

        .portal-actions {
            display: flex;
            gap: 0.8rem;
            margin-top: 1.2rem;
            justify-content: center;
        }

        .portal-submit {
            font-family: var(--font-mono);
            font-size: 0.65rem;
            font-weight: 400;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--amber-deep);
            background: transparent;
            border: 1px solid var(--amber-ring);
            padding: 0.8rem 2rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .portal-submit:hover {
            background: var(--amber-soft);
            border-color: var(--amber);
        }

        .portal-mic {
            width: 44px; height: 44px;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--border-glass);
            color: var(--text-muted);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0;
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
        }

        .portal-mic:hover { border-color: var(--red); color: var(--red); }

        .portal-mic.recording {
            border-color: var(--red);
            background: rgba(185, 28, 28, 0.06);
            color: var(--red);
            animation: mic-pulse-light 1s ease-in-out infinite;
        }

        @keyframes mic-pulse-light {
            0%, 100% { box-shadow: 0 0 0 0 rgba(185, 28, 28, 0); }
            50% { box-shadow: 0 0 0 8px rgba(185, 28, 28, 0.08); }
        }

        .portal-mic svg { width: 18px; height: 18px; fill: currentColor; }

        .portal-response { text-align: center; margin-top: 2rem; display: none; }
        .portal-response.show { display: block; }

        .portal-response p {
            font-family: var(--font-body);
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 0.5rem;
        }

        .portal-credentials {
            background: rgba(255,255,255,0.6);
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--border-glass);
            border-radius: 8px;
            padding: 1rem 1.5rem;
            margin-top: 1rem;
            display: inline-block;
            box-shadow: 0 1px 4px rgba(0,0,0,0.03);
        }

        .portal-credentials code {
            font-family: var(--font-mono);
            font-size: 0.8rem;
            color: var(--amber-deep);
            display: block;
            margin: 0.2rem 0;
            letter-spacing: 0.05em;
        }

        .portal-48h {
            font-family: var(--font-mono);
            font-size: 0.55rem;
            color: var(--text-light);
            letter-spacing: 0.2em;
            text-transform: uppercase;
            margin-top: 1rem;
        }

        /* Portal Chat UI */
        .portal-login-form {
            max-width: 360px;
            margin: 1.5rem auto 0;
        }
        .portal-input {
            width: 100%;
            padding: 0.85rem 1rem;
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            background: var(--bg-surface);
            color: var(--text-primary);
            font-family: var(--font-body);
            font-size: 0.95rem;
            backdrop-filter: blur(10px);
        }
        .portal-input:focus { outline: none; border-color: var(--amber); }
        .portal-input::placeholder { color: var(--text-light); }
        .portal-error {
            color: var(--red);
            font-family: var(--font-body);
            font-size: 0.85rem;
            min-height: 1.5em;
            margin: 0.5rem 0;
            text-align: center;
        }

        .portal-chat {
            max-width: 700px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            height: calc(100vh - 160px);
            min-height: 400px;
        }
        .portal-chat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-subtle);
            margin-bottom: 0.5rem;
        }
        .portal-chat-name {
            font-family: var(--font-display);
            font-size: 1.2rem;
            color: var(--text-primary);
        }
        .portal-chat-logout {
            font-family: var(--font-body);
            font-size: 0.8rem;
            color: var(--text-muted);
            background: none;
            border: 1px solid var(--border-subtle);
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .portal-chat-logout:hover { border-color: var(--red); color: var(--red); }

        .portal-chat-tabs {
            display: flex;
            gap: 0;
            margin-bottom: 0.5rem;
        }
        .portal-chat-tab {
            flex: 1;
            padding: 0.6rem;
            text-align: center;
            font-family: var(--font-body);
            font-size: 0.8rem;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
        }
        .portal-chat-tab.active { color: var(--amber); border-bottom-color: var(--amber); }

        .portal-messages-wrap {
            flex: 1;
            overflow-y: auto;
            padding: 0.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
        }
        .portal-info-wrap {
            flex: 1;
            padding: 1.5rem;
            font-family: var(--font-body);
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .pmsg {
            max-width: 80%;
            padding: 0.7rem 1rem;
            border-radius: 12px;
            font-family: var(--font-body);
            font-size: 0.9rem;
            line-height: 1.5;
            word-wrap: break-word;
        }
        .pmsg-user {
            align-self: flex-end;
            background: var(--amber);
            color: #fff;
            border-bottom-right-radius: 4px;
        }
        .pmsg-admin {
            align-self: flex-start;
            background: var(--bg-surface);
            color: var(--text-primary);
            border-bottom-left-radius: 4px;
        }
        .pmsg-time {
            font-size: 0.65rem;
            opacity: 0.6;
            margin-top: 0.2rem;
        }
        .pmsg-empty {
            color: var(--text-light);
            text-align: center;
            padding: 3rem 1rem;
            font-style: italic;
            font-family: var(--font-body);
        }

        .portal-input-bar {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            padding: 0.75rem 0;
            border-top: 1px solid var(--border-subtle);
        }
        .portal-attach-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border-subtle);
            border-radius: 50%;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            flex-shrink: 0;
        }
        .portal-attach-btn:hover { border-color: var(--amber); }
        .portal-msg-input {
            flex: 1;
            padding: 0.7rem 1rem;
            border: 1px solid var(--border-subtle);
            border-radius: 20px;
            background: var(--bg-surface);
            color: var(--text-primary);
            font-family: var(--font-body);
            font-size: 0.9rem;
        }
        .portal-msg-input:focus { outline: none; border-color: var(--amber); }
        .portal-send-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--amber);
            border: none;
            color: #fff;
            cursor: pointer;
            font-size: 1.1rem;
            flex-shrink: 0;
            transition: background 0.3s;
        }
        .portal-send-btn:hover { background: var(--amber-deep); }
        .portal-send-btn:disabled { background: var(--text-light); cursor: not-allowed; }

        /* ========================================
           AUDIO MODAL
           ======================================== */
        .audio-modal {
            position: fixed;
            inset: 0;
            z-index: 600;
            background: rgba(0, 0, 0, 0.35);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
        }

        .audio-modal.open { opacity: 1; pointer-events: auto; }

        .audio-modal-content {
            text-align: center; max-width: 400px; padding: 2.5rem;
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-radius: 14px; border: 1px solid var(--border-glass);
            box-shadow: 0 10px 50px rgba(0,0,0,0.08);
        }

        .audio-modal-title {
            font-family: var(--font-display);
            font-size: 1.25rem;
            color: var(--text-primary);
            margin-bottom: 0.3rem;
        }

        .audio-modal-sub {
            font-family: var(--font-mono);
            font-size: 0.55rem;
            color: var(--text-light);
            letter-spacing: 0.15em;
            margin-bottom: 1.5rem;
        }

        .audio-modal audio { width: 100%; max-width: 300px; }

        .audio-modal-close {
            font-family: var(--font-mono);
            font-size: 0.6rem;
            letter-spacing: 0.2em;
            color: var(--text-muted);
            background: transparent;
            border: none;
            cursor: pointer;
            margin-top: 1.2rem;
            padding: 0.5rem 1rem;
            transition: color 0.3s ease;
            text-transform: uppercase;
        }

        .audio-modal-close:hover { color: var(--text-secondary); }

        .audio-modal-langs {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-bottom: 1rem;
        }
        .audio-lang-btn {
            background: transparent;
            border: 1px solid rgba(122,107,78,0.3);
            color: var(--text-secondary);
            font-family: var(--font-mono);
            font-size: 0.65rem;
            letter-spacing: 0.15em;
            padding: 0.3rem 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        .audio-lang-btn.active {
            border-color: var(--accent);
            color: var(--accent);
        }
        .audio-lang-btn:hover {
            border-color: var(--text-secondary);
        }

        .audio-modal-attr {
            font-family: var(--font-mono);
            font-size: 0.45rem;
            color: var(--text-light);
            letter-spacing: 0.1em;
            margin-top: 0.8rem;
            opacity: 0.5;
        }

        /* Bottom entity ambient — organism's pulse at page bottom */
        .bottom-entity {
            position: fixed;
            bottom: -5%;
            left: 50%;
            transform: translateX(-50%);
            width: clamp(300px, 50vw, 600px);
            height: clamp(300px, 50vw, 600px);
            border-radius: 50%;
            overflow: hidden;
            pointer-events: none;
            z-index: 0;
            opacity: 0.07;
            mix-blend-mode: multiply;
            filter: blur(2px);
        }

        .bottom-entity video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .bottom-entity.loaded {
            animation: bottom-breathe 8s ease-in-out infinite;
        }

        @keyframes bottom-breathe {
            0%, 100% { opacity: 0.07; transform: translateX(-50%) scale(1); }
            50% { opacity: 0.11; transform: translateX(-50%) scale(1.03); }
        }

        /* Fallback glow for when video doesn't load */
        .bottom-entity-fallback {
            position: fixed;
            bottom: -8%;
            left: 50%;
            transform: translateX(-50%);
            width: clamp(300px, 45vw, 500px);
            height: clamp(300px, 45vw, 500px);
            border-radius: 50%;
            background: radial-gradient(circle, rgba(122,107,78,0.08) 0%, rgba(122,107,78,0.03) 40%, transparent 70%);
            pointer-events: none;
            z-index: 0;
            animation: bottom-glow 6s ease-in-out infinite;
        }

        @keyframes bottom-glow {
            0%, 100% { opacity: 0.6; transform: translateX(-50%) scale(1); }
            50% { opacity: 1; transform: translateX(-50%) scale(1.05); }
        }

        /* ========================================
           RESPONSIVE
           ======================================== */
        @media (max-width: 768px) {
            .site-header { padding: 1rem; }
            .home {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto;
                justify-items: center;
                padding: 5rem 1.5rem 3rem;
            }
            .entity-container {
                grid-column: 1;
                grid-row: 1;
                width: 240px;
                height: 240px;
            }
            .home-info {
                grid-column: 1;
                grid-row: 2;
                padding-left: 0;
                text-align: center;
                align-self: start;
                margin-top: 1rem;
            }
            .home-fullname-large { text-align: center; }
            .home-philosophy p { margin: 0 auto; }
            .limb-tooltip { display: none; }
            .assembly-grid { grid-template-columns: 1fr; }
            .portal-actions { flex-direction: column; align-items: center; }
            .fog-blob { filter: blur(60px); }
            .fog-blob.amber-1 { width: 250px; height: 250px; }
            .fog-blob.teal-1 { width: 220px; height: 220px; }
            .fog-blob.purple-1 { width: 200px; height: 200px; }
            .fog-blob.orange-1 { width: 180px; height: 180px; }
            .fog-blob.blue-1 { width: 200px; height: 200px; }
            .bottom-entity, .bottom-entity-fallback { width: 220px; height: 220px; bottom: -8%; }
        }

        @media (max-width: 480px) {
            .entity-container { width: 240px; height: 240px; }
            .limb-label { font-size: 0.45rem; }
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            .fog-blob { display: none; }
            .bottom-entity, .bottom-entity-fallback { display: none; }
        }
    </style>
</head>
<body>

<!-- LIVING BACKGROUND -->
<div class="bg-layer">
    <div class="fog-blob amber-1"></div>
    <div class="fog-blob teal-1"></div>
    <div class="fog-blob purple-1"></div>
    <div class="fog-blob orange-1"></div>
    <div class="fog-blob blue-1"></div>
    <div class="bg-grain"></div>
</div>

<!-- NERVE NETWORK — organism's connective tissue -->
<div class="nerve-network" id="nerveNetwork">
    <svg id="nerveSvg" xmlns="http://www.w3.org/2000/svg"></svg>
</div>

<div id="unsupported-gate">
    <p>Bu site, cihazınızın mevcut teknolojisiyle görüntülenemiyor.<br><br>This site requires a more capable device to display.</p>
</div>

<div id="intro-overlay">
    <div class="intro-core"></div>
</div>

<div id="app">
    <header class="site-header">
        <div class="lang-toggle">
            <button class="lang-btn active" data-lang="tr">TR</button>
            <button class="lang-btn" data-lang="en">EN</button>
        </div>
        <div class="nav-wrapper">
            <button class="hamburger" id="hamburgerBtn" aria-label="Menü">
                <div class="hamburger-lines"><span></span><span></span><span></span></div>
                <div class="hamburger-label" data-tr="menü" data-en="menu">menü</div>
            </button>
            <nav class="nav-dropdown" id="navDropdown">
                <ul class="nav-menu">
                    <li><a class="nav-link" href="/" data-page="home"><span data-tr="Ana" data-en="Home">Ana</span><span class="nav-link-sub" data-tr="organizma" data-en="organism">organizma</span></a></li>
                    <li><a class="nav-link" href="/core/" data-page="core"><span data-tr="Çekirdek" data-en="Core">Çekirdek</span><span class="nav-link-sub" data-tr="düşünce gövdesi" data-en="thought trunk">düşünce gövdesi</span></a></li>
                    <li><a class="nav-link" href="/assembly/" data-page="assembly"><span data-tr="Meclis" data-en="Assembly">Meclis</span><span class="nav-link-sub" data-tr="uzuvlar" data-en="limbs">uzuvlar</span></a></li>
                    <li><a class="nav-link" href="/emanations/" data-page="emanations"><span data-tr="Yayılımlar" data-en="Emanations">Yayılımlar</span><span class="nav-link-sub" data-tr="çıktılar" data-en="outputs">çıktılar</span></a></li>
                    <li><a class="nav-link" href="/portal/" data-page="portal"><span data-tr="Portal" data-en="Portal">Portal</span><span class="nav-link-sub" data-tr="kapı" data-en="gate">kapı</span></a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="page home active" id="page-home">
        <div class="entity-container" id="entityContainer">
            <svg class="connections-svg" id="connectionsSvg"></svg>
            <div class="entity-core" id="entityCore"></div>
            <div class="entity-video-layer" id="videoLayer">
                <video muted playsinline loop preload="none"
                       poster="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E%3Crect fill='%23D6CEC2' width='1' height='1'/%3E%3C/svg%3E">
                    <source src="/assets/video/entity_loop.webm" type="video/webm">
                    <source src="/assets/video/entity_loop.mp4" type="video/mp4">
                </video>
            </div>
            <div class="entity-name">
                <div class="entity-name-primary">HALİT</div>
            </div>
            <div class="orbital-ring" id="orbitalRing"></div>
        </div>
        <div class="home-info">
            <div class="home-fullname-large">
                <span>Halit</span>
                <span>Cengiz</span>
                <span>Uzuner</span>
            </div>
            <div class="home-philosophy">
                <p data-tr="1995'ten beri hukukçu. Uzun süredir aktif pratik yok. Kalan: düşünme disiplini, argümantasyon refleksi, ve sunumun mesajın parçası olduğu inancı." data-en="Jurist since 1995. Long out of active practice. What remains: thinking discipline, argumentation reflex, and the conviction that presentation is part of the message.">1995'ten beri hukukçu. Uzun süredir aktif pratik yok. Kalan: düşünme disiplini, argümantasyon refleksi, ve sunumun mesajın parçası olduğu inancı.</p>
            </div>
            <div class="home-fullname"><span data-tr="Meraklı Zihin" data-en="Curious Mind">Meraklı Zihin</span></div>
        </div>
    </main>

    <section class="page page-core" id="page-core">
        <div class="page-gradient amber-gradient"></div>
        <div class="core-header">
            <h1 class="core-title" data-tr="Çekirdek" data-en="Core">Çekirdek</h1>
            <div class="core-subtitle" data-tr="düşünce gövdesi" data-en="thought trunk">düşünce gövdesi</div>
        </div>
        <div class="core-body" data-tr="1995'ten beri hukukçu. Uzun süredir aktif pratik yok. Kalan: düşünme disiplini, argümantasyon refleksi, ve sunumun mesajın parçası olduğu inancı. Alan yok, sınır yok — merak nereye çekerse oraya." data-en="Jurist since 1995. Long out of active practice. What remains: thinking discipline, argumentation reflex, and the conviction that presentation is part of the message. No fixed field, no boundaries — curiosity leads.">
            1995'ten beri hukukçu. Uzun süredir aktif pratik yok. Kalan: düşünme disiplini, argümantasyon refleksi, ve sunumun mesajın parçası olduğu inancı. Alan yok, sınır yok — merak nereye çekerse oraya.
        </div>
        <div class="branches-title" data-tr="dallar" data-en="branches">dallar</div>
        <div class="branch-filters" id="branchFilters"></div>
        <div class="branches-container" id="branchesContainer"></div>
    </section>

    <section class="page page-assembly" id="page-assembly">
        <div class="page-gradient multi-gradient"></div>
        <div class="assembly-header">
            <h1 class="assembly-title" data-tr="Meclis" data-en="Assembly">Meclis</h1>
            <div class="assembly-subtitle" data-tr="uzuvlar" data-en="limbs">uzuvlar</div>
        </div>
        <div class="assembly-grid" id="assemblyGrid"></div>
    </section>

    <section class="page page-emanations" id="page-emanations">
        <div class="page-gradient teal-gradient"></div>
        <div class="emanations-header">
            <h1 class="emanations-title" data-tr="Yayılımlar" data-en="Emanations">Yayılımlar</h1>
            <div class="emanations-subtitle" data-tr="çekirdekten yayılan" data-en="emanating from core">çekirdekten yayılan</div>
        </div>
        <div class="emanation-filters" id="emanationFilters"></div>
        <div id="emanationsContainer"></div>
    </section>

    <section class="page page-portal" id="page-portal" style="position:relative;">
        <div class="page-gradient red-gradient"></div>
        
        <!-- Portal Login -->
        <div class="portal-login" id="portalLogin">
            <div class="portal-header">
                <h1 class="portal-title">Portal</h1>
                <p class="portal-statement" data-tr="Güvenli iletişim kanalı." data-en="Secure communication channel.">Güvenli iletişim kanalı.</p>
            </div>

            <!-- Seçim butonları -->
            <div class="portal-choice">
                <button class="portal-choice-btn active" id="portalChoiceLogin" data-tr="Hesabım var" data-en="I have an account">Hesabım var</button>
                <button class="portal-choice-btn" id="portalChoiceRequest" data-tr="Erişim talep et" data-en="Request access">Erişim talep et</button>
            </div>

            <!-- Giriş formu -->
            <div class="portal-login-form" id="portalLoginForm">
                <input type="text" class="portal-input" id="portalUsername" autocomplete="username" style="margin-bottom:0.75rem;">
                <input type="password" class="portal-input" id="portalPassword" autocomplete="current-password">
                <div class="portal-error" id="portalError"></div>
                <div class="portal-actions">
                    <button class="portal-submit" id="portalLoginBtn" data-tr="Giriş Yap" data-en="Log In">Giriş Yap</button>
                </div>
            </div>

            <!-- Talep formu -->
            <div class="portal-form" id="portalRequestForm" style="display:none; max-width:360px; margin:0 auto;">
                <p class="portal-statement" style="text-align:center; margin-bottom:1.5rem;" data-tr="Kendinizi tanıtın. Yazılı veya sesli." data-en="Introduce yourself. Text or voice.">Kendinizi tanıtın. Yazılı veya sesli.</p>
                <textarea class="portal-textarea" id="portalRequestText" maxlength="500" rows="4"></textarea>
                <div class="portal-char-count"><span id="portalCharCount">0</span> / 500</div>
                <div class="portal-actions">
                    <button class="portal-mic" id="portalMicBtn" title="Ses kaydı">
                        <svg viewBox="0 0 24 24"><path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1-9c0-.55.45-1 1-1s1 .45 1 1v6c0 .55-.45 1-1 1s-1-.45-1-1V5zm6 6c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/></svg>
                    </button>
                    <button class="portal-submit" id="portalRequestBtn" data-tr="Gönder" data-en="Submit">Gönder</button>
                </div>
                <div class="portal-error" id="portalRequestError"></div>
            </div>

            <!-- Talep sonuç -->
            <div class="portal-response" id="portalResponse">
                <p data-tr="Talebiniz alındı. 48 saat içinde değerlendirilecektir." data-en="Your request has been received. It will be evaluated within 48 hours.">Talebiniz alındı. 48 saat içinde değerlendirilecektir.</p>
                <div class="portal-credentials" id="portalCredentials"></div>
                <p class="portal-48h" data-tr="Bu bilgileri kaydedin — giriş için gerekecektir" data-en="Save these credentials — you'll need them to log in">Bu bilgileri kaydedin — giriş için gerekecektir</p>
            </div>
        </div>

        <!-- Portal Chat (giriş sonrası) -->
        <div class="portal-chat" id="portalChat" style="display:none;">
            <div class="portal-chat-header">
                <span class="portal-chat-name" id="portalChatName"></span>
                <button class="portal-chat-logout" id="portalLogout" data-tr="Çıkış" data-en="Logout">Çıkış</button>
            </div>
            <div class="portal-chat-tabs">
                <button class="portal-chat-tab active" data-ptab="messages" data-tr="Mesajlar" data-en="Messages">Mesajlar</button>
                <button class="portal-chat-tab" data-ptab="info" data-tr="Bilgi" data-en="Info">Bilgi</button>
            </div>
            <div class="portal-messages-wrap" id="portalMessagesWrap">
                <div class="portal-messages" id="portalMessages"></div>
            </div>
            <div class="portal-info-wrap" id="portalInfoWrap" style="display:none;">
                <p id="portalInfoText"></p>
            </div>
            <div class="portal-input-bar" id="portalInputBar">
                <label class="portal-attach-btn" title="Dosya ekle">
                    📎
                    <input type="file" id="portalFileInput" accept="image/*,audio/*,.pdf,.doc,.docx" style="display:none;">
                </label>
                <input type="text" class="portal-msg-input" id="portalMsgInput">
                <button class="portal-send-btn" id="portalSendBtn">➤</button>
            </div>
        </div>
    </section>
</div>

<!-- BOTTOM ENTITY — organism's pulse at page bottom -->
<div class="bottom-entity" id="bottomEntity">
    <video muted playsinline loop preload="none"
           poster="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E%3Crect fill='%23D6CEC2' width='1' height='1'/%3E%3C/svg%3E">
        <source src="/assets/video/entity_loop.webm" type="video/webm">
        <source src="/assets/video/entity_loop.mp4" type="video/mp4">
    </video>
</div>
<div class="bottom-entity-fallback" id="bottomEntityFallback"></div>

<div class="audio-modal" id="audioModal">
    <div class="audio-modal-content">
        <div class="audio-modal-langs" id="audioModalLangs" style="display:none;">
            <button class="audio-lang-btn" data-lang="tr">TR</button>
            <button class="audio-lang-btn" data-lang="en">EN</button>
        </div>
        <div class="audio-modal-title" id="audioModalTitle"></div>
        <div class="audio-modal-sub" id="audioModalSub"></div>
        <audio controls preload="none" id="audioPlayer"></audio>
        <br>
        <button class="audio-modal-close" id="audioModalClose" data-tr="Kapat" data-en="Close">Kapat</button>
        <div class="audio-modal-attr" id="audioModalAttr"></div>
    </div>
</div>

<script>
(function() {
    'use strict';

    const isCapable = (
        'IntersectionObserver' in window &&
        CSS.supports('display', 'grid') &&
        CSS.supports('(--a: 0)')
    );

    if (!isCapable) {
        document.getElementById('unsupported-gate').style.display = 'flex';
        document.getElementById('intro-overlay').style.display = 'none';
        document.getElementById('app').style.display = 'none';
        return;
    }

    const limbs = [
        { id: 'sancak', name: 'SANCAK', tool: 'Claude', color: 'var(--teal)', colorHex: '#4A706A',
          role: { tr: 'Yapısal düşünce, argümantasyon, analiz, yazım, kod, çeviri', en: 'Structural thinking, argumentation, analysis, writing, code, translation' },
          status: 'active', angle: 0 },
        { id: 'poyraz', name: 'POYRAZ', tool: 'NotebookLM', color: 'var(--blue)', colorHex: '#4A6A8A',
          role: { tr: 'Kaynak sentezi, çapraz okuma, podcast üretimi', en: 'Source synthesis, cross-reading, podcast generation' },
          status: 'active', angle: 51.4 },
        { id: 'yankiz', name: 'YANKIZ', tool: 'ElevenLabs Reader', color: 'var(--purple)', colorHex: '#6B5B7B',
          role: { tr: 'Metin → ses dönüşümü, dinleme arayüzü', en: 'Text to voice, listening interface' },
          status: 'active', angle: 102.8 },
        { id: 'kiran', name: 'KIRAN', tool: 'Adobe Acrobat', color: 'var(--red)', colorHex: '#8B5A5A',
          role: { tr: 'Belge işleme, PDF düzenleme', en: 'Document processing, PDF editing' },
          status: 'active', angle: 154.2 },
        { id: 'fiske', name: 'FİSKE', tool: 'Whisper', color: 'var(--green)', colorHex: '#5A7A5A',
          role: { tr: 'Ses → metin transkripsiyon', en: 'Voice to text transcription' },
          status: 'active', angle: 205.6 },
        { id: 'isil', name: 'IŞIL', tool: 'Runway', color: 'var(--orange)', colorHex: '#8A6A4A',
          role: { tr: 'Video üretimi, görsel kimlik', en: 'Video generation, visual identity' },
          status: 'active', angle: 257 },
        { id: 'soluk', name: 'SOLUK', tool: 'DeepL', color: 'var(--silver)', colorHex: '#7A7A7A',
          role: { tr: 'Çeviri desteği', en: 'Translation support' },
          status: 'sleeping', angle: 308.4 }
    ];

    const branches = [
        { date: '2026-01-30',
          title: { tr: '\u201CAynen Öyle\u201D \u2014 Minimal Onay İfadeleri', en: '\u201CAynen Öyle\u201D \u2014 Minimal Affirmation Expressions' },
          desc: { tr: 'Epistemik ve sosyal işlevleri üzerine araştırma notu ve podcast.', en: 'Research note on epistemic and social functions, with podcast.' },
          status: 'completed' },
        { date: '2026-02-20',
          title: { tr: 'Sturgeon Yasası \u2014 Her \u015Eeyin %90\u2019\u0131', en: 'Sturgeon\u2019s Law \u2014 90% of Everything' },
          desc: { tr: 'Vasatl\u0131\u011F\u0131n evrensel da\u011F\u0131l\u0131m\u0131 \u00FCzerine ara\u015Ft\u0131rma notu.', en: 'Research note on universal distribution of mediocrity.' },
          status: 'active' }
    ].sort((a, b) => b.date.localeCompare(a.date));

    const emanations = [
        { id: 'aynen-oyle',
          category: { tr: 'DİL', en: 'LANGUAGE' },
          date: '2026-01-30',
          title: { tr: '"Aynen Öyle" — Minimal Onay İfadelerinin Epistemik ve Sosyal İşlevleri', en: '"Aynen Öyle" — Epistemic and Social Functions of Minimal Affirmation Expressions' },
          summary: { tr: 'Günlük dilde sıkça kullandığımız "aynen", "aynen öyle" gibi ifadelerin arkasındaki düşünce mekanizmalarını inceleyen araştırma notu.', en: 'A research note examining the cognitive mechanisms behind commonly used affirmation expressions.' },
          readUrl: '/raporlar/aynen-oyle.html',
          audioUrl: {
              tr: 'https://pub-09be185c608d4c1e80131e5f82eaca40.r2.dev/podcast.mp3',
              en: 'https://pub-09be185c608d4c1e80131e5f82eaca40.r2.dev/ElevenLabs_The_Evolution_of_Language_in_the_Digital_Age.mp3'
          },
          audioTitle: { tr: 'Podcast', en: 'Podcast' },
          audioSub: { tr: 'TR ~18 dk · EN ~5 dk', en: 'TR ~18 min · EN ~5 min' },
          audioAttr: { tr: 'POYRAZ \u00B7 Google NotebookLM', en: 'YANKIZ \u00B7 ElevenLabs' },
          illustration: '<svg viewBox="0 0 280 80" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="10" y="10" width="105" height="46" rx="10" stroke="#7A6B4E" stroke-width="1" opacity="0.35"/><line x1="24" y1="24" x2="100" y2="24" stroke="#7A6B4E" stroke-width="0.8" opacity="0.22" stroke-linecap="round"/><line x1="24" y1="33" x2="90" y2="33" stroke="#7A6B4E" stroke-width="0.8" opacity="0.22" stroke-linecap="round"/><line x1="24" y1="42" x2="68" y2="42" stroke="#7A6B4E" stroke-width="0.8" opacity="0.22" stroke-linecap="round"/><path d="M32 56 L26 70 L46 56" stroke="#7A6B4E" stroke-width="1" opacity="0.3" fill="none"/><circle cx="134" cy="33" r="1.2" fill="#A09A90" opacity="0.25"/><circle cx="145" cy="33" r="1.2" fill="#A09A90" opacity="0.25"/><circle cx="156" cy="33" r="1.2" fill="#A09A90" opacity="0.25"/><rect x="175" y="18" width="68" height="30" rx="10" stroke="#4A706A" stroke-width="1.2" opacity="0.4"/><circle cx="209" cy="33" r="2.5" fill="#4A706A" opacity="0.3"/><path d="M224 48 L232 60 L218 48" stroke="#4A706A" stroke-width="1.2" opacity="0.4" fill="none"/></svg>' },
        { id: 'sturgeon-yasasi',
          category: { tr: 'D\u00DC\u015E\u00DCNCE', en: 'THOUGHT' },
          date: '2026-02-20',
          title: { tr: 'Sturgeon Yasas\u0131 \u2014 \u201CHer \u015Eeyin Y\u00FCzde Doksan\u0131 \u00C7\u00F6pt\u00FCr\u201D', en: 'Sturgeon\u2019s Law \u2014 \u201CNinety Percent of Everything Is Crud\u201D' },
          summary: { tr: 'Vasatl\u0131\u011F\u0131n evrensel da\u011F\u0131l\u0131m\u0131: bilimkurgudan kanser ara\u015Ft\u0131rmalar\u0131na, Spotify\u2019dan antik Yunan\u2019a uzanan veri destekli bir ara\u015Ft\u0131rma notu.', en: 'Universal distribution of mediocrity: a data-backed research note spanning sci-fi to cancer research, Spotify to ancient Greece.' },
          readUrl: '/raporlar/sturgeon-yasasi.html',
          audioUrl: {
              tr: 'https://pub-09be185c608d4c1e80131e5f82eaca40.r2.dev/sturgeon-yasasi-tr.m4a',
              en: 'https://pub-09be185c608d4c1e80131e5f82eaca40.r2.dev/sturgeon-yasasi-en.m4a'
          },
          audioTitle: { tr: 'Podcast', en: 'Podcast' },
          audioSub: { tr: 'TR ~20 dk · EN ~23 dk', en: 'TR ~20 min · EN ~23 min' },
          illustration: '<svg viewBox="0 0 280 30" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16" cy="15" r="5" fill="#7A6B4E" opacity="0.1"/><circle cx="44" cy="15" r="5" fill="#7A6B4E" opacity="0.1"/><circle cx="72" cy="15" r="5" fill="#7A6B4E" opacity="0.1"/><circle cx="100" cy="15" r="5" fill="#7A6B4E" opacity="0.1"/><circle cx="128" cy="15" r="5" fill="#7A6B4E" opacity="0.1"/><circle cx="156" cy="15" r="5" fill="#7A6B4E" opacity="0.1"/><circle cx="184" cy="15" r="5" fill="#7A6B4E" opacity="0.1"/><circle cx="212" cy="15" r="5" fill="#7A6B4E" opacity="0.1"/><circle cx="240" cy="15" r="5" fill="#7A6B4E" opacity="0.1"/><circle cx="264" cy="15" r="5.5" fill="#4A706A" opacity="0.5"/></svg>' }
    ].sort((a, b) => b.date.localeCompare(a.date));

    let currentLang = localStorage.getItem('siteLang') || 'tr';

    function setLanguage(lang) {
        currentLang = lang;
        localStorage.setItem('siteLang', lang);
        document.documentElement.lang = lang;
        document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.toggle('active', btn.dataset.lang === lang));
        document.querySelectorAll('[data-tr]').forEach(el => { if (el.dataset[lang]) el.textContent = el.dataset[lang]; });
        // Portal input placeholders
        const pu = document.getElementById('portalUsername');
        const pp = document.getElementById('portalPassword');
        if (pu) pu.placeholder = lang === 'tr' ? 'Kullanıcı adı' : 'Username';
        if (pp) pp.placeholder = lang === 'tr' ? 'Şifre' : 'Password';
        const pmi = document.getElementById('portalMsgInput');
        if (pmi) pmi.placeholder = lang === 'tr' ? 'Mesajınızı yazın...' : 'Write your message...';
        renderBranches();
        renderAssembly();
        renderEmanations();
        updateMeta(currentPage);
    }

    // ============================================
    // SEO: Sayfa bazlı meta bilgileri
    // ============================================
    var pageMeta = {
        home: {
            title: { tr: 'Halit Cengiz Uzuner', en: 'Halit Cengiz Uzuner' },
            desc: { tr: 'Dijital organizma. Düşünme disiplini, argümantasyon refleksi, sınırsız merak.', en: 'Digital organism. Thinking discipline, argumentation reflex, boundless curiosity.' }
        },
        core: {
            title: { tr: 'Çekirdek — Halit Cengiz Uzuner', en: 'Core — Halit Cengiz Uzuner' },
            desc: { tr: 'Düşünce gövdesi. 1995\'ten beri hukukçu. Düşünme disiplini, argümantasyon refleksi.', en: 'Thought trunk. Jurist since 1995. Thinking discipline, argumentation reflex.' }
        },
        assembly: {
            title: { tr: 'Meclis — Halit Cengiz Uzuner', en: 'Assembly — Halit Cengiz Uzuner' },
            desc: { tr: 'Uzuvlar. Claude, NotebookLM, ElevenLabs, Adobe Acrobat, Whisper, Runway, DeepL.', en: 'Limbs. Claude, NotebookLM, ElevenLabs, Adobe Acrobat, Whisper, Runway, DeepL.' }
        },
        emanations: {
            title: { tr: 'Yayılımlar — Halit Cengiz Uzuner', en: 'Emanations — Halit Cengiz Uzuner' },
            desc: { tr: 'Çekirdekten yayılan araştırma notları ve çıktılar.', en: 'Research notes and outputs emanating from core.' }
        },
        portal: {
            title: { tr: 'Portal — Halit Cengiz Uzuner', en: 'Portal — Halit Cengiz Uzuner' },
            desc: { tr: 'Güvenli iletişim kanalı.', en: 'Secure communication channel.' }
        }
    };

    function updateMeta(pageId) {
        var meta = pageMeta[pageId] || pageMeta.home;
        document.title = meta.title[currentLang];
        var descEl = document.querySelector('meta[name="description"]');
        if (descEl) descEl.setAttribute('content', meta.desc[currentLang]);
        var ogTitle = document.querySelector('meta[property="og:title"]');
        if (ogTitle) ogTitle.setAttribute('content', meta.title[currentLang]);
        var ogDesc = document.querySelector('meta[property="og:description"]');
        if (ogDesc) ogDesc.setAttribute('content', meta.desc[currentLang]);
        var twTitle = document.querySelector('meta[name="twitter:title"]');
        if (twTitle) twTitle.setAttribute('content', meta.title[currentLang]);
        var twDesc = document.querySelector('meta[name="twitter:description"]');
        if (twDesc) twDesc.setAttribute('content', meta.desc[currentLang]);
        var canonical = document.querySelector('link[rel="canonical"]');
        if (canonical) {
            var url = pageId === 'home' ? 'https://halitcengizuzuner.com/' : 'https://halitcengizuzuner.com/' + pageId + '/';
            canonical.setAttribute('href', url);
        }
    }

    let currentPage = 'home';
    const hamburger = document.getElementById('hamburgerBtn');
    const navDropdown = document.getElementById('navDropdown');

    hamburger.addEventListener('click', (e) => {
        e.stopPropagation();
        hamburger.classList.toggle('open');
        navDropdown.classList.toggle('open');
    });

    document.addEventListener('click', (e) => {
        if (!e.target.closest('.nav-wrapper')) {
            hamburger.classList.remove('open');
            navDropdown.classList.remove('open');
        }
    });

    function navigateTo(pageId, skipPush) {
        if (pageId === currentPage) { hamburger.classList.remove('open'); navDropdown.classList.remove('open'); return; }
        const oldPage = document.getElementById('page-' + currentPage);
        const newPage = document.getElementById('page-' + pageId);
        if (!newPage) return;
        hamburger.classList.remove('open');
        navDropdown.classList.remove('open');
        oldPage.classList.add('exiting');
        setTimeout(() => {
            oldPage.classList.remove('active', 'exiting');
            oldPage.style.display = 'none';
            newPage.style.display = '';
            newPage.classList.add('active');
            currentPage = pageId;
            window.scrollTo(0, 0);
            if (!skipPush) {
                var url = pageId === 'home' ? '/' : '/' + pageId + '/';
                window.history.pushState({ page: pageId }, '', url);
            }
            updateMeta(pageId);
            if (pageId === 'home') {
                requestAnimationFrame(() => { renderOrbitals(); generateNerveNetwork(); });
            }
        }, 300);
    }

    document.querySelectorAll('.nav-link').forEach(link => {
        link.addEventListener('click', (e) => { e.preventDefault(); navigateTo(link.dataset.page); });
    });

    // popstate: tarayıcı geri/ileri
    window.addEventListener('popstate', function(e) {
        var pageId = (e.state && e.state.page) ? e.state.page : 'home';
        if (pageId !== currentPage && document.getElementById('page-' + pageId)) {
            var oldPage = document.getElementById('page-' + currentPage);
            var newPage = document.getElementById('page-' + pageId);
            oldPage.classList.remove('active');
            oldPage.style.display = 'none';
            newPage.style.display = '';
            newPage.classList.add('active');
            currentPage = pageId;
            window.scrollTo(0, 0);
            updateMeta(pageId);
            if (pageId === 'home') {
                requestAnimationFrame(() => { renderOrbitals(); generateNerveNetwork(); });
            }
        }
    });

    // SPA routing: query param > sessionStorage > pathname > hash
    var validPages = { '': 'home', 'core': 'core', 'assembly': 'assembly', 'emanations': 'emanations', 'portal': 'portal' };
    var initialRoute = '';
    var urlParams = new URLSearchParams(window.location.search);
    if (urlParams.has('p')) {
        initialRoute = urlParams.get('p');
    } else {
        var spaRedirect = sessionStorage.getItem('spa-redirect');
        if (spaRedirect) {
            sessionStorage.removeItem('spa-redirect');
            initialRoute = spaRedirect.replace(/^\/|\/$/g, '');
        } else if (window.location.pathname !== '/') {
            initialRoute = window.location.pathname.replace(/^\/|\/$/g, '');
        } else if (window.location.hash) {
            initialRoute = window.location.hash.replace('#', '');
        }
    }
    var startPage = validPages[initialRoute] || 'home';
    if (startPage !== 'home' && document.getElementById('page-' + startPage)) {
        document.getElementById('page-home').classList.remove('active');
        document.getElementById('page-home').style.display = 'none';
        document.getElementById('page-' + startPage).classList.add('active');
        currentPage = startPage;
        var cleanUrl = '/' + startPage + '/';
        window.history.replaceState({ page: startPage }, '', cleanUrl);
        updateMeta(startPage);
    } else {
        window.history.replaceState({ page: 'home' }, '', window.location.pathname === '/' ? '/' : '/');
    }

    function renderOrbitals() {
        const ring = document.getElementById('orbitalRing');
        const svg = document.getElementById('connectionsSvg');
        const container = document.getElementById('entityContainer');
        const w = container.offsetWidth;
        const h = container.offsetHeight;
        const cx = w / 2;
        const cy = h / 2;
        const radius = Math.min(cx, cy) * 0.78;
        ring.innerHTML = '';
        let svgLines = '';
        limbs.forEach(limb => {
            const rad = (limb.angle - 90) * (Math.PI / 180);
            const x = cx + radius * Math.cos(rad);
            const y = cy + radius * Math.sin(rad);
            svgLines += `<line class="connection-line" x1="${cx}" y1="${cy}" x2="${x}" y2="${y}"/>`;
            const node = document.createElement('div');
            node.className = 'limb-node' + (limb.status === 'sleeping' ? ' sleeping' : '');
            node.style.left = x + 'px';
            node.style.top = y + 'px';
            const tooltipBelow = y < h * 0.35;
            node.innerHTML = `
                <div class="limb-dot" style="background:${limb.color}; color:${limb.color};"></div>
                <div class="limb-label" style="color:${limb.color};">${limb.name}</div>
                <div class="limb-tooltip${tooltipBelow ? ' tooltip-below' : ''}">
                    <div class="limb-tooltip-name">${limb.tool}</div>
                    <div class="limb-tooltip-role">${limb.role[currentLang]}</div>
                </div>`;
            ring.appendChild(node);
        });
        svg.innerHTML = svgLines;
    }

    var activeBranchFilter = 'all';

    function renderBranchFilters() {
        var counts = { active: 0, completed: 0 };
        branches.forEach(function(b) { counts[b.status]++; });
        var labels = {
            all: currentLang === 'tr' ? 'Tümü' : 'All',
            active: currentLang === 'tr' ? 'Aktif' : 'Active',
            completed: currentLang === 'tr' ? 'Tamamlandı' : 'Completed'
        };
        var html = '';
        ['all', 'active', 'completed'].forEach(function(key) {
            var count = key === 'all' ? branches.length : counts[key];
            if (key !== 'all' && count === 0) return;
            html += '<button class="branch-filter-btn' + (activeBranchFilter === key ? ' active' : '') + '" data-filter="' + key + '">' + labels[key] + '<span class="branch-filter-count">' + count + '</span></button>';
        });
        document.getElementById('branchFilters').innerHTML = html;
    }

    function renderBranches() {
        renderBranchFilters();
        document.getElementById('branchesContainer').innerHTML = branches.map(function(b) {
            var hidden = activeBranchFilter !== 'all' && activeBranchFilter !== b.status;
            return '<div class="branch-card glass-card"' + (hidden ? ' style="display:none;"' : '') + '>' +
                '<div class="branch-date">' + b.date + '</div>' +
                '<div class="branch-title">' + b.title[currentLang] + '</div>' +
                '<div class="branch-desc">' + b.desc[currentLang] + '</div>' +
                '<span class="branch-status ' + b.status + '">' + (b.status === 'active' ? (currentLang === 'tr' ? 'aktif' : 'active') : (currentLang === 'tr' ? 'tamamlandı' : 'completed')) + '</span>' +
            '</div>';
        }).join('');
    }

    document.getElementById('branchFilters').addEventListener('click', function(e) {
        var btn = e.target.closest('.branch-filter-btn');
        if (!btn) return;
        activeBranchFilter = btn.dataset.filter;
        renderBranches();
    });

    function renderAssembly() {
        document.getElementById('assemblyGrid').innerHTML = limbs.map(l => `
            <div class="limb-card glass-card">
                <div style="position:absolute;top:0;left:0;right:0;height:2px;background:${l.color};"></div>
                <div class="limb-card-header">
                    <div class="limb-card-dot" style="background:${l.color};"></div>
                    <div class="limb-card-persona" style="color:${l.color};">${l.name}</div>
                </div>
                <div class="limb-card-tool">${l.tool}</div>
                <div class="limb-card-role">${l.role[currentLang]}</div>
                <div class="limb-card-status" style="color:${l.status === 'sleeping' ? 'var(--text-light)' : l.color};">
                    <span class="status-dot ${l.status === 'sleeping' ? 'sleeping' : ''}" style="background:${l.color};"></span>
                    ${l.status === 'active' ? (currentLang === 'tr' ? 'aktif' : 'active') : (currentLang === 'tr' ? 'uyuyan' : 'sleeping')}
                </div>
            </div>`).join('');
    }

    var activeFilter = 'all';

    function renderEmanationFilters() {
        var cats = {};
        emanations.forEach(function(em) {
            var key = em.category.en.toLowerCase();
            if (!cats[key]) cats[key] = { tr: em.category.tr, en: em.category.en, count: 0 };
            cats[key].count++;
        });
        var allLabel = currentLang === 'tr' ? 'Tümü' : 'All';
        var html = '<button class="emanation-filter-btn' + (activeFilter === 'all' ? ' active' : '') + '" data-filter="all">' + allLabel + '<span class="emanation-filter-count">' + emanations.length + '</span></button>';
        Object.keys(cats).forEach(function(key) {
            var c = cats[key];
            html += '<button class="emanation-filter-btn' + (activeFilter === key ? ' active' : '') + '" data-filter="' + key + '">' + c[currentLang] + '<span class="emanation-filter-count">' + c.count + '</span></button>';
        });
        document.getElementById('emanationFilters').innerHTML = html;
    }

    function renderEmanations() {
        renderEmanationFilters();
        document.getElementById('emanationsContainer').innerHTML = emanations.map(function(em, idx) {
            var catKey = em.category.en.toLowerCase();
            var hidden = activeFilter !== 'all' && activeFilter !== catKey;
            return '<div class="emanation-card glass-card" data-category="' + catKey + '"' + (hidden ? ' style="display:none;"' : '') + '>' +
                (em.illustration ? '<div class="emanation-illustration">' + em.illustration + '</div>' : '') +
                '<div class="emanation-meta">' +
                    '<span class="emanation-category">' + em.category[currentLang] + '</span>' +
                    '<span class="emanation-date">' + em.date + '</span>' +
                '</div>' +
                '<div class="emanation-title">' + em.title[currentLang] + '</div>' +
                '<div class="emanation-summary">' + em.summary[currentLang] + '</div>' +
                '<div class="emanation-actions">' +
                    '<a href="' + em.readUrl + '" class="emanation-btn">' + (currentLang === 'tr' ? 'Oku' : 'Read') + '</a>' +
                    (em.audioUrl ? '<a href="#" class="emanation-btn listen" data-emanation-idx="' + idx + '">' + 'Podcast' + '</a>' : '') +
                '</div>' +
            '</div>';
        }).join('');
    }

    document.getElementById('emanationFilters').addEventListener('click', function(e) {
        var btn = e.target.closest('.emanation-filter-btn');
        if (!btn) return;
        activeFilter = btn.dataset.filter;
        renderEmanations();
    });

    var currentAudioEmanation = null;

    function openAudioModal(idx) {
        var em = emanations[idx];
        currentAudioEmanation = em;
        var hasMultiLang = typeof em.audioUrl === 'object' && em.audioUrl.tr && em.audioUrl.en;
        var langsEl = document.getElementById('audioModalLangs');

        if (hasMultiLang) {
            langsEl.style.display = '';
            setAudioLang(currentLang);
        } else {
            langsEl.style.display = 'none';
            var url = typeof em.audioUrl === 'object' ? em.audioUrl[currentLang] : em.audioUrl;
            var attr = em.audioAttr ? (typeof em.audioAttr === 'object' ? em.audioAttr[currentLang] : em.audioAttr) : '';
            setAudioContent(url, em.audioTitle[currentLang], em.audioSub[currentLang], attr);
        }

        document.getElementById('audioModal').classList.add('open');
        document.body.style.overflow = 'hidden';
    }

    function setAudioLang(lang) {
        var em = currentAudioEmanation;
        var url = em.audioUrl[lang];
        var attr = em.audioAttr ? (typeof em.audioAttr === 'object' ? em.audioAttr[lang] : em.audioAttr) : '';
        setAudioContent(url, em.audioTitle[lang], em.audioSub[lang], attr);
        document.querySelectorAll('.audio-lang-btn').forEach(function(b) {
            b.classList.toggle('active', b.dataset.lang === lang);
        });
    }

    function setAudioContent(url, title, sub, attr) {
        document.getElementById('audioModalTitle').textContent = title;
        document.getElementById('audioModalSub').textContent = sub;
        document.getElementById('audioModalAttr').textContent = attr || '';
        var player = document.getElementById('audioPlayer');
        player.src = url;
        player.load();
    }

    function closeAudioModal() {
        var p = document.getElementById('audioPlayer'); p.pause(); p.src = '';
        document.getElementById('audioModal').classList.remove('open');
        document.body.style.overflow = '';
        currentAudioEmanation = null;
    }

    document.addEventListener('click', function(e) {
        var btn = e.target.closest('.emanation-btn.listen[data-emanation-idx]');
        if (btn) {
            e.preventDefault();
            openAudioModal(parseInt(btn.dataset.emanationIdx));
        }
        var langBtn = e.target.closest('.audio-lang-btn');
        if (langBtn && currentAudioEmanation) {
            setAudioLang(langBtn.dataset.lang);
        }
    });

    document.getElementById('audioModalClose').addEventListener('click', closeAudioModal);

    document.getElementById('audioModal').addEventListener('click', function(e) {
        if (e.target === e.currentTarget) closeAudioModal();
    });


    // ============================================
    // PORTAL CHAT SYSTEM
    // ============================================
    const PORTAL_API = 'https://portal.halitcengizuzuner.workers.dev';
    let portalUserId = null;
    let portalSession = null;

    // Portal choice toggle
    document.getElementById('portalChoiceLogin').addEventListener('click', () => {
        document.getElementById('portalChoiceLogin').classList.add('active');
        document.getElementById('portalChoiceRequest').classList.remove('active');
        document.getElementById('portalLoginForm').style.display = '';
        document.getElementById('portalRequestForm').style.display = 'none';
        document.getElementById('portalResponse').classList.remove('show');
    });
    document.getElementById('portalChoiceRequest').addEventListener('click', () => {
        document.getElementById('portalChoiceRequest').classList.add('active');
        document.getElementById('portalChoiceLogin').classList.remove('active');
        document.getElementById('portalLoginForm').style.display = 'none';
        document.getElementById('portalRequestForm').style.display = '';
    });

    // Karakter sayacı
    document.getElementById('portalRequestText').addEventListener('input', function() {
        document.getElementById('portalCharCount').textContent = this.value.length;
    });

    // Ses kaydı
    let mediaRecorder = null;
    let audioChunks = [];
    let isRecording = false;

    document.getElementById('portalMicBtn').addEventListener('click', async () => {
        const btn = document.getElementById('portalMicBtn');
        if (isRecording) {
            mediaRecorder.stop();
            btn.classList.remove('recording');
            isRecording = false;
            return;
        }
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            mediaRecorder = new MediaRecorder(stream, { mimeType: 'audio/webm' });
            audioChunks = [];
            mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
            mediaRecorder.onstop = () => {
                stream.getTracks().forEach(t => t.stop());
            };
            mediaRecorder.start();
            btn.classList.add('recording');
            isRecording = true;
        } catch (e) {
            const errEl = document.getElementById('portalRequestError');
            errEl.textContent = currentLang === 'tr' ? 'Mikrofon erişimi reddedildi' : 'Microphone access denied';
        }
    });

    // Talep gönder
    document.getElementById('portalRequestBtn').addEventListener('click', async () => {
        const text = document.getElementById('portalRequestText').value.trim();
        const errEl = document.getElementById('portalRequestError');
        const hasAudio = audioChunks.length > 0;

        if (!text && !hasAudio) {
            errEl.textContent = currentLang === 'tr' ? 'Lütfen talebinizi yazın veya sesli iletin.' : 'Please write or record your request.';
            return;
        }
        errEl.textContent = '';
        document.getElementById('portalRequestBtn').disabled = true;

        try {
            const fd = new FormData();
            fd.append('text', text);
            if (hasAudio) {
                const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                fd.append('audio', audioBlob, 'request.webm');
            }
            const r = await fetch(PORTAL_API + '/api/request-access', { method: 'POST', body: fd });
            const data = await r.json();
            if (data.success) {
                document.getElementById('portalRequestForm').style.display = 'none';
                document.getElementById('portalCredentials').innerHTML =
                    `<code>${currentLang === 'tr' ? 'Kullanıcı' : 'Username'}: ${data.username}</code><code>${currentLang === 'tr' ? 'Şifre' : 'Password'}: ${data.password}</code>`;
                document.getElementById('portalResponse').classList.add('show');
                document.querySelector('.portal-choice').style.display = 'none';
            } else {
                errEl.textContent = data.error;
            }
        } catch (e) {
            errEl.textContent = currentLang === 'tr' ? 'Bağlantı hatası' : 'Connection error';
        }
        document.getElementById('portalRequestBtn').disabled = false;
    });

    document.getElementById('portalLoginBtn').addEventListener('click', portalLogin);
    document.getElementById('portalPassword').addEventListener('keydown', e => {
        if (e.key === 'Enter') portalLogin();
    });

    async function portalLogin() {
        const username = document.getElementById('portalUsername').value.trim();
        const password = document.getElementById('portalPassword').value;
        const errorEl = document.getElementById('portalError');
        if (!username || !password) {
            errorEl.textContent = currentLang === 'tr' ? 'Kullanıcı adı ve şifre gerekli' : 'Username and password required';
            return;
        }
        errorEl.textContent = '';
        document.getElementById('portalLoginBtn').disabled = true;
        try {
            const r = await fetch(PORTAL_API + '/api/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ username, password })
            });
            const data = await r.json();
            if (data.success) {
                portalUserId = data.userId;
                portalSession = { password };
                document.getElementById('portalChatName').textContent = data.name;
                document.getElementById('portalInfoText').textContent = data.message || (currentLang === 'tr' ? 'Hoş geldiniz.' : 'Welcome.');
                renderPortalMessages(data.messages || []);
                document.getElementById('portalLogin').style.display = 'none';
                document.getElementById('portalChat').style.display = 'flex';
            } else {
                errorEl.textContent = data.error;
            }
        } catch (e) {
            errorEl.textContent = currentLang === 'tr' ? 'Bağlantı hatası' : 'Connection error';
        }
        document.getElementById('portalLoginBtn').disabled = false;
    }

    document.getElementById('portalLogout').addEventListener('click', () => {
        portalUserId = null;
        portalSession = null;
        document.getElementById('portalChat').style.display = 'none';
        document.getElementById('portalLogin').style.display = '';
        document.getElementById('portalUsername').value = '';
        document.getElementById('portalPassword').value = '';
        document.getElementById('portalError').textContent = '';
    });

    // Tab switching
    document.querySelectorAll('.portal-chat-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.portal-chat-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            const isMessages = tab.dataset.ptab === 'messages';
            document.getElementById('portalMessagesWrap').style.display = isMessages ? '' : 'none';
            document.getElementById('portalInputBar').style.display = isMessages ? '' : 'none';
            document.getElementById('portalInfoWrap').style.display = isMessages ? 'none' : '';
        });
    });

    function renderPortalMessages(messages) {
        const c = document.getElementById('portalMessages');
        if (!messages.length) {
            c.innerHTML = `<div class="pmsg-empty">${currentLang === 'tr' ? 'Henüz mesaj yok.' : 'No messages yet.'}</div>`;
            return;
        }
        c.innerHTML = messages.map(m => {
            const isUser = m.from === 'user';
            const time = new Date(m.timestamp).toLocaleString(currentLang === 'tr' ? 'tr-TR' : 'en-US');
            let content = '';
            if (m.type === 'image') content = `<img src="${m.url}" style="max-width:100%;border-radius:6px;">`;
            else if (m.type === 'audio') content = `<audio controls src="${m.url}" style="width:100%;"></audio><div style="font-size:0.75em;opacity:0.7;">${escapeHtmlPortal(m.text)}</div>`;
            else if (m.type === 'file') content = `<a href="${m.url}" target="_blank" style="color:inherit;text-decoration:underline;">📎 ${escapeHtmlPortal(m.text)}</a>`;
            else content = escapeHtmlPortal(m.text);
            return `<div class="pmsg ${isUser ? 'pmsg-user' : 'pmsg-admin'}"><div>${content}</div><div class="pmsg-time">${time}</div></div>`;
        }).join('');
        c.scrollTop = c.scrollHeight;
    }

    function escapeHtmlPortal(t) {
        const d = document.createElement('div');
        d.textContent = t;
        return d.innerHTML;
    }

    // Send message
    document.getElementById('portalSendBtn').addEventListener('click', portalSendMsg);
    document.getElementById('portalMsgInput').addEventListener('keydown', e => {
        if (e.key === 'Enter') portalSendMsg();
    });

    async function portalSendMsg() {
        const input = document.getElementById('portalMsgInput');
        const text = input.value.trim();
        if (!text || !portalUserId) return;
        const btn = document.getElementById('portalSendBtn');
        btn.disabled = true;
        try {
            const r = await fetch(PORTAL_API + '/api/' + portalUserId + '/message', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text })
            });
            const data = await r.json();
            if (data.success) {
                input.value = '';
                appendPortalMsg(data.message);
            }
        } catch (e) {}
        btn.disabled = false;
        input.focus();
    }

    // File upload
    document.getElementById('portalFileInput').addEventListener('change', async function() {
        const file = this.files[0];
        if (!file || !portalUserId) return;
        try {
            const fd = new FormData();
            fd.append('file', file);
            const r = await fetch(PORTAL_API + '/api/' + portalUserId + '/upload', {
                method: 'POST',
                body: fd
            });
            const data = await r.json();
            if (data.success) appendPortalMsg(data.message);
        } catch (e) {}
        this.value = '';
    });

    function appendPortalMsg(m) {
        const c = document.getElementById('portalMessages');
        const empty = c.querySelector('.pmsg-empty');
        if (empty) empty.remove();
        const isUser = m.from === 'user';
        const time = new Date(m.timestamp).toLocaleString(currentLang === 'tr' ? 'tr-TR' : 'en-US');
        let content = '';
        if (m.type === 'image') content = `<img src="${m.url}" style="max-width:100%;border-radius:6px;">`;
        else if (m.type === 'audio') content = `<audio controls src="${m.url}" style="width:100%;"></audio>`;
        else if (m.type === 'file') content = `<a href="${m.url}" target="_blank" style="color:inherit;">📎 ${escapeHtmlPortal(m.text)}</a>`;
        else content = escapeHtmlPortal(m.text);
        const div = document.createElement('div');
        div.className = 'pmsg ' + (isUser ? 'pmsg-user' : 'pmsg-admin');
        div.innerHTML = `<div>${content}</div><div class="pmsg-time">${time}</div>`;
        c.appendChild(div);
        c.scrollTop = c.scrollHeight;
    }

    function initVideoLayer() {
        const layer = document.getElementById('videoLayer');
        const video = layer.querySelector('video');
        video.preload = 'auto';
        video.addEventListener('playing', () => {
            setTimeout(() => { if (video.videoWidth > 0 && !video.paused) layer.classList.add('loaded'); }, 500);
        });
        video.play().catch(() => {});
    }

    // Bottom entity ambient video
    function initBottomEntity() {
        var el = document.getElementById('bottomEntity');
        var video = el.querySelector('video');
        var fallback = document.getElementById('bottomEntityFallback');

        video.preload = 'auto';

        var confirmed = false;

        function onPlaying() {
            setTimeout(function() {
                if (video.videoWidth > 0 && !video.paused) {
                    confirmed = true;
                    el.classList.add('loaded');
                    fallback.style.display = 'none';
                }
            }, 500);
        }

        video.addEventListener('playing', onPlaying);
        video.play().catch(function() {});

        // Fallback: if video doesn't play after 3s, keep CSS glow
        setTimeout(function() {
            if (!confirmed) {
                el.style.display = 'none';
            }
        }, 3000);
    }

    // Nerve network — organism's connective tissue
    function generateNerveNetwork() {
        var svg = document.getElementById('nerveSvg');
        var w = window.innerWidth;
        var h = window.innerHeight;
        svg.setAttribute('viewBox', '0 0 ' + w + ' ' + h);

        var paths = '';
        // Generate random nerve paths from edges toward center region
        var nodeCount = window.innerWidth < 768 ? 12 : 22;
        var nodes = [];

        // Create nodes spread across viewport
        for (var i = 0; i < nodeCount; i++) {
            nodes.push({
                x: Math.random() * w,
                y: Math.random() * h
            });
        }

        // Draw connections between nearby nodes
        for (var i = 0; i < nodes.length; i++) {
            for (var j = i + 1; j < nodes.length; j++) {
                var dx = nodes[i].x - nodes[j].x;
                var dy = nodes[i].y - nodes[j].y;
                var dist = Math.sqrt(dx * dx + dy * dy);
                var maxDist = Math.min(w, h) * 0.4;

                if (dist < maxDist) {
                    // Curved path via bezier
                    var mx = (nodes[i].x + nodes[j].x) / 2 + (Math.random() - 0.5) * 80;
                    var my = (nodes[i].y + nodes[j].y) / 2 + (Math.random() - 0.5) * 80;
                    paths += '<path class="nerve-line" d="M' + nodes[i].x + ',' + nodes[i].y + ' Q' + mx + ',' + my + ' ' + nodes[j].x + ',' + nodes[j].y + '"/>';
                }
            }
            // Node dot
            paths += '<circle class="nerve-dot" cx="' + nodes[i].x + '" cy="' + nodes[i].y + '" r="2"/>';
        }

        svg.innerHTML = paths;
    }

    function runIntro() {
        setTimeout(() => {
            document.getElementById('intro-overlay').classList.add('fade-out');
            document.getElementById('app').classList.add('visible');
            renderOrbitals();
            generateNerveNetwork();
            renderBranches();
            renderAssembly();
            renderEmanations();
            setTimeout(function() { initVideoLayer(); initBottomEntity(); }, 500);
        }, 2000);
        setTimeout(() => { const o = document.getElementById('intro-overlay'); if (o) o.remove(); }, 2800);
    }

    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', () => { setLanguage(btn.dataset.lang); renderOrbitals(); });
    });

    let resizeTimer;
    window.addEventListener('resize', () => { clearTimeout(resizeTimer); resizeTimer = setTimeout(function() { renderOrbitals(); generateNerveNetwork(); }, 200); });
    document.addEventListener('keydown', e => {
        if (e.key === 'Escape') { hamburger.classList.remove('open'); navDropdown.classList.remove('open'); document.getElementById('audioModalClose').click(); }
    });

    setLanguage(currentLang);

    if (startPage !== 'home') {
        // Skip intro when deep-linking or returning from a report
        var introEl = document.getElementById('intro-overlay');
        if (introEl) introEl.remove();
        document.getElementById('app').classList.add('visible');
        renderOrbitals();
        generateNerveNetwork();
        setTimeout(function() { initVideoLayer(); initBottomEntity(); }, 100);
    } else {
        runIntro();
    }
})();
</script>
<script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "bf905439cb494c0aac6a1fa1d4de00ef"}'></script>
</body>
</html>
